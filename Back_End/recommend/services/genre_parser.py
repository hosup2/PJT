# services/genre_parser.py

GENRE_KEYWORDS = {
    # 공포 / 스릴
    "공포": ["공포"],
    "무서운": ["공포"],
    "호러": ["공포"],
    "귀신": ["공포"],
    "소름": ["공포", "스릴러"],
    "잔인": ["공포", "스릴러"],

    # 스릴러 / 미스터리
    "스릴러": ["스릴러"],
    "긴장감": ["스릴러"],
    "서스펜스": ["스릴러"],
    "추리": ["미스터리"],
    "미스터리": ["미스터리"],
    "반전": ["스릴러", "미스터리"],
    "수사": ["범죄", "미스터리"],

    # 액션
    "액션": ["액션"],
    "박진감": ["액션"],
    "전투": ["액션"],
    "싸움": ["액션"],
    "히어로": ["액션", "SF"],
    "폭발": ["액션"],

    # 로맨스
    "로맨스": ["로맨스"],
    "사랑": ["로맨스"],
    "연애": ["로맨스"],
    "멜로": ["로맨스"],
    "설렘": ["로맨스"],
    "달달": ["로맨스"],
    "이별": ["로맨스", "드라마"],

    # 코미디
    "코미디": ["코미디"],
    "웃긴": ["코미디"],
    "유머": ["코미디"],
    "개그": ["코미디"],
    "가볍게": ["코미디"],
    "힐링": ["코미디", "드라마"],

    # 드라마
    "드라마": ["드라마"],
    "감동": ["드라마"],
    "눈물": ["드라마"],
    "인생": ["드라마"],
    "현실적인": ["드라마"],
    "잔잔": ["드라마"],
    "먹먹": ["드라마"],

    # 가족
    "가족": ["가족"],
    "아이랑": ["가족"],
    "어린이": ["가족"],

    # 애니메이션
    "애니": ["애니메이션"],
    "애니메이션": ["애니메이션"],
    "만화": ["애니메이션"],
    "지브리": ["애니메이션", "판타지"],

    # 판타지 / SF
    "판타지": ["판타지"],
    "마법": ["판타지"],
    "용": ["판타지"],
    "SF": ["SF"],
    "공상과학": ["SF"],
    "우주": ["SF"],
    "미래": ["SF"],
    "로봇": ["SF"],

    # 범죄
    "범죄": ["범죄"],
    "마피아": ["범죄"],
    "조직": ["범죄"],
    "갱": ["범죄"],
    "느와르": ["범죄"],

    # 전쟁 / 역사
    "전쟁": ["전쟁"],
    "군인": ["전쟁"],
    "2차대전": ["전쟁", "역사"],
    "역사": ["역사"],
    "실화": ["역사", "드라마"],

    # 음악
    "음악": ["음악"],
    "뮤지컬": ["음악"],
    "노래": ["음악"],
    "밴드": ["음악"],

    # 서부 / 모험
    "서부": ["서부"],
    "카우보이": ["서부"],
    "모험": ["모험"],
    "여행": ["모험"],
    "탐험": ["모험"],

    # 다큐
    "다큐": ["다큐멘터리"],
    "다큐멘터리": ["다큐멘터리"],
    "기록": ["다큐멘터리"],
}


def extract_genres_from_text(text: str) -> list[str]:
    """
    사용자 입력에서 장르 키워드 추출
    """
    if not text:
        return []

    text = text.lower()
    genres = set()

    for keyword, mapped_genres in GENRE_KEYWORDS.items():
        if keyword in text:
            for g in mapped_genres:
                genres.add(g)

    return list(genres)
